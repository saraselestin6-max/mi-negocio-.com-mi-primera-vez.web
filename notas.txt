# server.js
cat > server.js << 'EOF'
const express = require("express");
const sqlite3 = require("sqlite3");
const bcrypt = require("bcrypt");
const path = require("path");

const app = express();
app.use(express.urlencoded({ extended: true }));

const db = new sqlite3.Database("database.db");

db.run(`
  CREATE TABLE IF NOT EXISTS users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT,
    email TEXT UNIQUE,
    password TEXT
  )
`);

app.get("/", (req, res) => {
  res.sendFile(path.join(__dirname, "register.html"));
});

app.post("/register", async (req, res) => {
  const { name, email, password } = req.body;
  const hash = await bcrypt.hash(password, 10);

  db.run(
    "INSERT INTO users (name, email, password) VALUES (?, ?, ?)",
    [name, email, hash],
    (err) => {
      if (err) return res.send("Este correo ya está registrado");
      res.send("Cuenta creada correctamente ✅");
    }
  );
});

app.listen(3000, () => {
  console.log("Servidor activo en http://localhost:3000");
});
EOF

# register.html
cat > register.html << 'EOF'
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Registro de Clientes</title>
</head>
<body>
  <h2>Registro de Cliente</h2>

  <form method="POST" action="/register">
    <input type="text" name="name" placeholder="Nombre" required><br><br>
    <input type="email" name="email" placeholder="Correo" required><br><br>
    <input type="password" name="password" placeholder="Contraseña" required><br><br>
    <button type="submit">Crear cuenta</button>
  </form>
</body>
</html>
EOF
